Abstract
RNA viruses, characterized by exceptionally high mutation rates and adaptive potential, pose significant public health challenges to human society. Metagenomic sequencing has revealed a vast array of novel viral sequences; however, identifying viruses with high zoonotic potential remains a critical challenge for pandemic preparedness. Existing host prediction methods demonstrate limited coverage and accuracy for emerging viruses and uncommon hosts. To address the scalability and precision limitations of current models, this study developed a unified framework that simultaneously models associations across multiple viral families and diverse host taxa. Leveraging genomic language models, we embedded the complete gene repertoires of viruses and hosts into a shared representation space, with host features efficiently compressed based on protein functional classification. The model was trained on cluster-level data encompassing 90 viral families and 240 host families, achieving a species-level host prediction accuracy of 87.37% for unknown viruses—representing improvements of 15.76% and 28.81% over k-mer-based and BLASTp methods, respectively. Feature interpretation revealed that viral structural proteins and host immune- and metabolism-related genes contributed most significantly to predictive performance. Based on model predictions, we identified several potentially human-infective novel viruses, predominantly within Picornaviridae, whose predicted mammalian host range expanded approximately 2-fold compared to known viruses. This work provides a novel computational strategy for early warning of emerging pathogens.

Requirements:
torch: 1.12.1.post201
pandas: 2.2.3
numpy: 2.2.4
matplotlib: 3.10.1
sklearn: 1.6.1

Processing steps:
	1. For the viruses to be predicted, perform functional annotation of their proteins using HMM, and simultaneously generate a CSV file containing all possible virus-host combinations for these viruses.
	2. Use the protein language model LucaOne (https://github.com/LucaOne/LucaOne) to calculate the embedding representation of each protein from the viruses to be predicted.

Data:
The corresponding data and required model files can be accessed by clicking [Zenodo](https://doi.org/10.5281/zenodo.17505409) to open the dataset page.

test:
During prediction, both the nucleotide and amino acid sequences of the virus are required.  
The nucleotide sequences are represented using embeddings generated by **LucaOne**,  
while the amino acid sequences are functionally annotated through **HMM** viral protein analysis.  
The `test` folder provides an example of coronavirus prediction.



# Virus-Host Interaction Prediction

## Overview
RNA viruses, characterized by exceptionally high mutation rates and adaptive potential, pose significant public health challenges. Metagenomic sequencing has revealed a vast array of novel viral sequences; however, identifying viruses with high zoonotic potential remains a critical challenge for pandemic preparedness. Existing host prediction methods demonstrate limited coverage and accuracy for emerging viruses and uncommon hosts.  

To address scalability and precision limitations, this study developed a unified framework that simultaneously models associations across multiple viral families and diverse host taxa. Leveraging genomic language models, the framework embeds the complete gene repertoires of viruses and hosts into a shared representation space, with host features efficiently compressed based on protein functional classification.  

The model was trained on cluster-level data encompassing 90 viral families and 240 host families, achieving a species-level host prediction accuracy of 87.37% for unknown viruses—representing improvements of 15.76% and 28.81% over k-mer-based and BLASTp methods, respectively. Feature interpretation revealed that viral structural proteins and host immune- and metabolism-related genes contributed most significantly to predictive performance. Based on model predictions, several potentially human-infective novel viruses were identified, predominantly within Picornaviridae, with an expanded predicted mammalian host range.

This work provides a novel computational strategy for early warning of emerging pathogens.

---

## Requirements
- Python packages:
  - `torch==1.12.1.post201`
  - `pandas==2.2.3`
  - `numpy==2.2.4`
  - `matplotlib==3.10.1`
  - `sklearn==1.6.1`

---

## Data Preparation
1. **Protein Functional Annotation**  
   - For the viruses to be predicted, annotate their proteins using **HMM**.  
   - Simultaneously, generate a CSV file containing all possible virus-host combinations for these viruses.

2. **Protein Embedding**  
   - Use the protein language model **[LucaOne](https://github.com/LucaOne/LucaOne)** to calculate embeddings for each protein of the viruses to be predicted.

3. **Dataset Access**  
   - The required data and pre-trained model files are available on **[Zenodo](https://doi.org/10.5281/zenodo.17505409)**.

---

## Usage
- During prediction, provide both nucleotide and amino acid sequences of the virus.  
  - **Nucleotide sequences** are represented using embeddings generated by **LucaOne**.  
  - **Amino acid sequences** are functionally annotated via **HMM**.  

- The `test` folder contains an example of coronavirus prediction to illustrate the workflow.

---

## Reference
If you use this dataset or framework, please cite the corresponding publication.





